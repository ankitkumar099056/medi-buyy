!function(){"use strict";define(["_routes","utility"],function(e,t){e.register.controller("consumerLabsController",["$scope","authService","apiProvider","$window","$rootScope","$timeout","$uibModal","$state","navConstantsSvc","standardEventsSvc","$stateParams","$sce","$location","localStorageService","corpLabsService","$interval",function(e,s,a,i,n,o,r,c,l,d,p,u,g,m,h,f){function b(){r.open({animation:!0,template:'<div class="modal-header"><h3 class="modal-title text-center"><strong>{{heading}}</strong></h3></div><div class="modal-body terms-modal"><div ng-repeat="row in rows"><div ng-bind-html="row"></div></div></div><div class="modal-footer"><div ng-if="!showDisclaimerButton"><button class="btn btn-primary btn-block" style="height:50px" ng-click="closeModal(true)">{{consentButtonText}}</button></div><div ng-if="showDisclaimerButton"><button class="btn btn-primary" style="height:50px;width:49%" ng-click="closeModal(true)">I Agree</button><button class="btn" style="height:50px;width:49%;background-color:#FFA500; color:#FFFFFF;" ng-click="closeModal(false)">I Decline</button></div></div>',scope:e,size:"md",controller:["$uibModalInstance","$scope",function(e,t){t.rows=M.cwcDisclaimer.content,t.heading=M.cwcDisclaimer.heading,t.closeModal=function(t){e.dismiss("cancel"),sessionStorage.setItem("hideConsentForm","true"),h.storeUserConsentStatus(t.toString())}}]})}function v(){e.isMobileView=n.isMobileView,e.cardPipeline={showBenefPopup:!1,reqBody:{category:"Default",loadSubCategories:!0,contractIds:[l.healthCheckContract,l.labtestContract]}},e.cartPipeline={},e.searchPipeline={},e.dialog=h.dialog,e.dialog.comparePackages=e.dialog.comparePackages&&(!M||M&&M.userDetails&&l.smartpackages.includes(M.userDetails.pmEntityID)),e.bannerExt=navigator.userAgent.indexOf("Chrome")>-1||navigator.userAgent.indexOf("Firefox")>-1?"webp":"png",e.pipeline={},e.activeBookingList=[],e.prevBookings=[],e.rxData=[],e.benefArray=s.benef,e.searchResults=[],e.mergeList=h.labsCart(),e.cardPipeline.showBenefPopup=e.mergeList.patients.length>1,e.lifeStyleList=[{filterValue:"",title:"Women's Health",value:"wh",imgSrc:"assets/icons/corpLabs/lifestyle/women-ls.svg"},{filterValue:"",title:"Obesity",value:"ob",imgSrc:"assets/icons/corpLabs/lifestyle/obesity-ls.svg"},{filterValue:"",title:"Smoking & Alcohol",value:"sa",imgSrc:"assets/icons/corpLabs/lifestyle/smoking-ls.svg"},{filterValue:"",title:"Diabetic",value:"db",imgSrc:"assets/icons/corpLabs/lifestyle/diabetic-ls.svg"},{filterValue:"",title:"Thyroid-Issues",value:"ti",imgSrc:"assets/icons/corpLabs/lifestyle/thyroid-ls.svg"}],e.matrixList=[{label:"Above 40 yrs Female",value:"fas",color:"#f40009",imgSrc:"/assets/images/corpLabs/a40-female.png"},{label:"Above 40 yrs Male",value:"mas",color:"#3f78f3",imgSrc:"/assets/images/corpLabs/a40-male.png"},{label:"Below 40 yrs Female",value:"fbs",color:"#f40009",imgSrc:"/assets/images/corpLabs/b40-female.png"},{label:"Below 40 yrs Male",value:"mbs",color:"#3f78f3",imgSrc:"/assets/images/corpLabs/b40-male.png"}],e.sectionList=[{label:{line1:"Book",line2:"Lab Tests"},id:"book-labs",tag:"",imgSrc:"https://views.medibuddy.in/labs/HomeScreenIcons/book-labtest.png",serviceType:"LabTests"},{label:{line1:"Popular",line2:"Health Checks"},id:"hc-packages",tag:"",imgSrc:"https://views.medibuddy.in/labs/HomeScreenIcons/popular-hc.png",serviceType:"PopularHealthCheckupPackages"},{label:{line1:"X-Rays,",line2:"Scans & MRI"},id:"radiology",tag:"",imgSrc:"https://views.medibuddy.in/labs/HomeScreenIcons/radiology.png",serviceType:"X-RaysScansMRIs"},{label:{line1:"Find",line2:"Hospitals/Labs"},id:"lab-centers",tag:"New",imgSrc:"https://views.medibuddy.in/labs/HomeScreenIcons/diagnostic-center.png",serviceType:"Diagnostics"}],e.reviews=[{rating:5,content:"Its a very essential application for everyone. One can simply book health checkups, blood tests , consult doctors and order medicines sitting at home. A big thumbs up to this app as it has really helped me during urgent times.",name:"Kaveri Kashyap",location:"",days:"23 February 2021"},{rating:5,content:"This is one of the best app for health checkups. Provides prompt service at economical packages. This app is very handy in emergencies.",name:"Shivangi Singh",location:"",days:"24 February 2021"},{rating:5,content:"Best app ever. One stop for all..either lab test , medicine home delivery or health insurance and consulting to dr. Its really good app",name:"Isha Manchanda",location:"",days:"24 February 2021"},{rating:5,content:"This app is very good. Online video call with any doc in 30 mins. Lab test booking also available and medicine delivered at your doorstep. There are some more amazing features",name:"Riddhi Shah",location:"",days:"28 February 2021"}],e.labsColorCode=["#fbf5fd","#defcfe","#fdf6e8","#fcefef"],e.labsWaveCode=["/assets/icons/covid/pink-wave.png","/assets/background/blue-wave-cov.png","/assets/icons/covid/yellow-wave.png","/assets/icons/covid/yellow-wave.png"],e.labsIcon=["/assets/icons/covid/pink-test.svg","/assets/icons/covid/green-test.svg","/assets/icons/covid/yellow-test.svg","/assets/icons/blood.svg"],e.faqs={},h.sendEvents("Booking Flow Labs landing page"),h.sendEventsV1(d.LABS_HOME_SCREEN_LANDING),h.providerParams={},C(),M&&S()}function k(){var t=M?M.token:null;s.makeAjaxCalls(a.apiUrl+"Labs/v1/HomeScreenBanners","","GET",t,e.selectedCity).then(function(t){t.data.isSuccess&&(e.sectionList=[],t.data.icons.forEach(function(t){if(!t.disabledOnWeb){var s=t.iconText.split(" "),a=s[0],i=s.slice(1).join(" ");e.sectionList.push({label:{line1:a,line2:i},id:t.serviceType,tag:t.iconTag,imgSrc:t.iconUrl,serviceType:t.serviceType,alt:t.alt})}}))})["catch"](function(e){console.log("Failed to retreive home page banners",e)})}function y(t,s,a,i){var n=_.union(e.mergeList.tests,e.mergeList.packages);_.isEmpty(t)&&(t=n),_.each(e.prevBookings,function(o){var r=t.find(function(e){return e.packageId==o.packageId});r?_.isEmpty(i)?(o.selected="+"==s,o.fromSearch="+"==s,o.cartId=r.cartId,o.showCount=e.cardPipeline.showBenefPopup?n.filter(function(e){return e.packageId==o.packageId}).length:0):_.each(i,function(e){o[e.key]=e.val}):a&&(_.isEmpty(i)?(o.selected=!1,o.fromSearch=!1,o.cartId=0,o.showCount=0):_.each(i,function(e){o[e.key]=!1}))})}function w(e){switch(e){case"Appointment Cancelled":case"Cancelled":return"/assets/icons/corpLabs/Failed.svg";case"Reports Uploaded":return"/assets/icons/check-warning-bg.svg";case"Processing Your Request":return"/assets/icons/order/processing.svg";case"Booking unsuccessful":return"/assets/icons/order/booking-failed.svg";case"Booking Failed":return"/assets/icons/order/booking-failed.svg";case"Order On Hold":return"/assets/icons/order/prescription-on-hold.svg";case"Prescription Under Verification":return"/assets/icons/order/verification-active.svg";case"Prescription Under Verification":return"/assets/icons/order/verification-active.svg";case"Processing Request":return"/assets/icons/order/processing.svg";default:return"/assets/icons/corpLabs/app-success.svg"}}function C(){var t=[{id:1,type:1,question:"How it works?",points:[{idx:1,pnt:"Search for required Lab tests and select Diagnostic centre of your choice. Add prescription, patient details and address to complete the booking.",img:"/assets/icons/labs/microscope.svg"},{idx:2,pnt:"Visit the lab centre as per your booking. For home sample collection, certified professional will collect the samples at your home.",img:"/assets/icons/labs/runner.svg"},{idx:3,pnt:"We will email you the reports. You can also access your reports within your account on the MediBuddy App.",img:"/assets/icons/message.svg"}],isExpanded:!0,icon:"assets/icons/static1.png"},{id:2,question:"How should I book an appointment for a Lab test/Health Checkup?",answer:"You can book an appointment via the following steps:",points:[{pnt:"Choose your city Pincode"},{pnt:"Choose your package/lab test & add it to the cart"},{pnt:"Add additional tests if needed"},{pnt:"You can book tests for family members"},{pnt:"Select slot & time"},{pnt:"Confirm your patient information"},{pnt:"Appointment confirmed"}],isExpanded:!1,icon:"assets/icons/static1.png"},{id:3,question:"How many days in advance do I need to book an appointment?",answer:"This depends on the availability of the diagnostic centers. During periods of high demand, the slots may not be available for at least 2 days from the date of booking",points:[],isExpanded:!1,icon:"assets/icons/static1.png"},{id:4,question:"Can an appointment be rescheduled?",answer:"Yes",points:[{pnt:"Select the Profile icon on the top-right corner"},{pnt:"Select Track orders"},{pnt:"Select Re-schedule"}],isExpanded:!1,icon:"assets/icons/static3.png"},{id:5,question:"Can an appointment be canceled?",answer:"Yes",points:[{pnt:"Select the Profile icon on the top-right corner"},{pnt:"Select Track orders"},{pnt:"Select Cancel"}],isExpanded:!1,icon:"assets/icons/static3.png"},{id:6,question:"When will I receive my Health Checkup reports?",answer:"Your Health Checkup report shall be available for download within 72 hours. Steps to download the report:",points:[{pnt:"Select the Profile icon on the top-right corner"},{pnt:"Select Track orders"},{pnt:"Select Download Report"}],isExpanded:!1,icon:"assets/icons/static2.png"},{id:7,question:"Are any documents required to undergo Health Checkup via MediBuddy?",answer:"You are required to carry the following documents:",points:[{pnt:"Appointment confirmation letter (Available in your Email or the Track Your Orders section)"},{pnt:"Government-issued Photo ID Card (Aadhar Card / Passport etc)"}],isExpanded:!1,icon:"assets/icons/static1.png"},{id:8,question:"What should I do before a Health Checkup?",answer:"You must follow the mentioned practices before a Health Checkup:",points:[{pnt:"Unless otherwise specified, you must fast overnight for 12 hours before the appointment. Only water can be consumed."},{pnt:"Avoid smoking or consuming alcohol for a minimum of 24 hours before the Health Checkup."},{pnt:"Women should not undergo Health Checkups at the time of menstruation."},{pnt:"Pregnant women should not undertake X-Ray."},{pnt:"You may carry urine & stool samples in a sterilized container obtainable from the nearest pharmacy. (if applicable)"},{pnt:"Specific to Centre visit Health Checkup:",subpnt:["Registration is mandatory at the medical centre; this may take 15-20 minutes.","Health Checkups at your medical centre may take 4-5 hours on weekdays and 5-6 hours on Saturdays. Kindly plan accordingly."]}],isExpanded:!1,icon:"assets/icons/static2.png"},{id:9,question:"Refund: In case of advance payment, will I be refunded for not making an appearance on the appointment date?",answer:"Yes",points:[{pnt:"Sponsored Health Checkup Packages will be available for booking again instantly."},{pnt:"Payments made through a payment gateway or a wallet will be refunded within 24 hours."}],isExpanded:!1,icon:"assets/icons/static1.png"}];if(e.isMobileView)e.faqs.arrayFirstHalf=t;else{var s=Math.ceil(t.length/2);e.faqs.arrayFirstHalf=t.slice(0,s),e.faqs.arraySecondHalf=t.slice(s,t.length)}}function P(){r.open({animation:!0,scope:e,backdrop:"none",template:'<div ng-class="{\'modal-bottom-header modal-header p-0\':isMobileView}"><div class="btn-border-close p-t-10 p-r-15 br-t-20 white-bg" style="height: 33px; display: block"><span class="cursor-pointer pull-right" ng-click="closeModal()"><img src="/assets/icons/close.svg" alt="close" height="20"></span></div><div><ng-include src="\'uploadRx.html\'"></ng-include></div></div>',controller:["$scope","$uibModalInstance",function(e,t){e.closeModal=function(){t.dismiss("cancel")}}],size:n.isMobileView?"bottom":"border",windowClass:n.isMobileView&&"bottom-sheet"}),h.sendEvents("Upload Rx Clicked")}function S(){if(M&&M.token){var t=h.fetchOrdersListing(!1,!0);t.then(function(t){var s=t.orders;e.activeBookingList=_.flatten(_.pluck(s,"patients")),_.each(e.activeBookingList,function(e){if(!_.isEmpty(e.requests)){var t=e.requests[0];e.orderId=t.orderId,e.appointmentDate=new Date(parseInt(t.appointmentDate.replace("/Date(","").replace(")/",""),10));var s=new Date(e.appointmentDate);s.setHours(s.getHours()+1),e.appointmentEndDate=s,e.address=e.orderCurrentStatus.isHomeSampleCollection?t.addressLine1?t.addressLine1+", "+t.addressLine2+", "+t.city:"":t.providerLocation,e.providerName=t.providerName,e.statusIcon=w(e.orderCurrentStatus.status),e.patientIcon=h.getGenderIcon(e.patientId,e.patientGender,e.patientAge)}})})}}function L(){M&&M.token&&s.makeAjaxCalls(a.apiUrl+"Labs/PrescribedTests.json","","GET",M.token,e.selectedCity,!0).then(function(t){t.data&&!_.isEmpty(t.data.data)&&_.each(t.data.data,function(t){_.isEmpty(t.tests)||(t.testsNA=[],t.testsAvailable=[],t.displayTxt=_.first(t.tests).mappedTest,_.each(t.tests,function(e){e.isMappedTest?e.isMappedTest&&t.testsAvailable.push(e):t.testsNA.push(e)}),t.rxTime>0&&(t.rxTime=new Date(t.rxTime)),e.rxData.push(t))})})["catch"](function(e){console.log("PrescribedTests failed",e)})}function I(t,s,a,i,n,o){e.famPipeline={selectedItems:t||[],op:s,refreshCart:a,transit:i,show:!0,mergeList:e.mergeList,"package":n&&_.isArray(t)&&1==t.length?t[0]:"",searchPackages:_.isArray(t)&&t.length>1?t:"",getAdditionalTests:o&&o.getAdditionalTests}}function T(e){var t="";switch(e){case"active-booking":t="Previous Orders";break;case"labTests":t="Lab Tests";break;case"hc-packages":t="Health Checks";break;case"prev-orders":t="Previous Orders";break;case"package-desc":t="Package Description Popup";break;case"search":t="Search Results";break;case"covid-search":t="Search Popular Covid Tests";break;case"tests-search":t="Search Popular Lab Tests";break;case"packages-search":t="Search Popular Health Checks";break;case"addtional-tests":t="suggestion carousel";break;case"compare-package-popup":t="Compare Package Popup"}return t}function E(){c.go("app.consumerCart")}function D(){var t=V["labSale-banners"];if(t){var s=(t.slide+1)%(n.isMobileView?e.labSale.length:e.labSale.length-1);t.scrollItem(s)}else f.cancel(R)}function x(){_.each(V,function(e,t){o.cancel(e),e&&(e.destroy(),V[t]=null,F[t]=null)})}window.updateSrc=!0,e.selectedCity=s.getCity();var A,B=s.getPincode(),M=s.isUserSignedin();window._Site_Props.__setServiceDetails({serviceName:"consumerLabs"});var H=!1;o(function(){if(window.location.hash){var e=window.location.href.split("#")[1],t=document.getElementById(e).offsetTop;t&&window.scrollTo({top:t-200,behavior:"smooth"})}else i.scrollTo(0,0)},1e3),M&&M.userDetails&&M.userDetails.pmEntityID?(e.showDisclaimerButton=l.AHCDisclaimerButtonForEntityIds.includes(M.userDetails.pmEntityID),e.checkUserConsentStatus=l.storeAHCConsentStatusForEntities.includes(M.userDetails.pmEntityID),e.consentButtonText=l.constentFormButtonText[M.userDetails.pmEntityID]?l.constentFormButtonText[M.userDetails.pmEntityID]:l.constentFormButtonText["default"]):e.consentButtonText=l.constentFormButtonText["default"],(M&&M.userDetails&&e.checkUserConsentStatus&&!M.userDetails.isAgreedToAHCConsent||!e.checkUserConsentStatus&&M.cwcDisclaimer&&M.cwcDisclaimer.eligible_places.includes("labs")&&"true"!=sessionStorage.getItem("hideConsentForm"))&&b(),M&&M.userDetails&&l.mchiEntityIds.indexOf(M.userDetails.pmEntityID)>-1&&(e.isMchiUser=!0,e.mobileNumber=M.userDetails.phone),v(),k(),e.onSectionListClick=function(e){switch(h.sendEvents("Labs Service Icon Clicked",{serviceType:e.serviceType}),e.id){case"AHC":c.go("app.consumercorplabs");break;case"UploadRx":P();break;case"Diagnostics":c.go("app.providerlisting");break;case"LabTests":c.go("app.labTestsListing");break;case"PopularHealthCheckupPackages":c.go("app.consumerPackages");break;case"X-RaysScansMRIs":c.go("app.radiologyTests");break;case"PreviousOrders":c.go("app.patientListing")}},e.callbanerClicked=function(){h.sendEvents("Booking Flow Call & Book Lab Test Banner Clicked")},i.onclick=function(s){var a=document.querySelector("#search-input");if(!e.dialog.searchPopover)return e.dialog.searchPopover=a&&a.contains(s.target),e.dialog.searchPopover&&(h.sendEvents("Search Page"),e.isMobileView&&o(function(){t.hideFooter(!0)})),void e.$apply();if(!e.isMobileView){var i=document.querySelector("#search-popover");i&&!i.contains(s.target)&&a&&!a.contains(s.target)&&(e.dialog.searchPopover=!1,e.$apply())}},e.handleBack=function(){e.dialog.searchPopover?(e.dialog.searchPopover=!1,e.isMobileView&&o(function(){t.hideFooter(!1)})):c.go("app.home")},e.toggleFaqsStatic=function(e,t){_.each(t.arrayFirstHalf,function(t){t.id!==e.id&&(t.isExpanded=!1)}),_.isEmpty(t.arraySecondHalf)||_.each(t.arraySecondHalf,function(t){t.id!==e.id&&(t.isExpanded=!1)}),e.isExpanded=!e.isExpanded},e.openPackageDetails=function(t){if(e.showDetailsPopUp)return h.sendEvents("PackageTestdetailspopup",{packageId:t.packageId,packageName:t.packageDisplayName,providerId:e.cardPipeline&&e.cardPipeline.providerId?e.cardPipeline.providerId:null,providerName:e.cardPipeline&&e.cardPipeline.providerName?e.cardPipeline.providerName:null}),e.packagePipeline.show=!0,void(e.packagePipeline.packageId=t.packageId);if(t.contractId==l.healthCheckContract)if(n.isMobileView)c.go("app.consumerPackages",{"package":t.packageId},{reload:!0});else{var s=window.location.origin;window.open(s+"/consumerPackages/"+t.packageId)}else if(n.isMobileView)c.go("app.consumerTests",{"package":t.packageId},{reload:!0});else{var s=window.location.origin;window.open(s+"/consumerTests/"+t.packageId+"/")}},e.confirmRefresh=function(t){var s=r.open({animation:!0,backdrop:"none",template:'<div class="modal-bottom-header modal-header p-t-10 p-l-20 p-r-20 primary-color"><div class="btn-border-close m-b-20"><span class="cursor-pointer pull-right" ng-style="{\'color\':isHover ? \'#000\' : \'#aaa\'}" ng-class="{\'md-dark-color\':isMobileView}"ng-init="isHover=false;" ng-mouseover="isHover=true;" ng-mouseout="isHover=false;" ng-click="closeModal()">close</span></div><div class="lgTxt bold">Are you Sure?</div></div><div class="modal-body primary-color modal-border-body p-t-0 clearfix"><div class="modal-body smdTxt"><span ng-if="selectedList.labs.length || selectedList.packages.length">Replace existing Tests from you cart with selected Tests and proceed.</span><span ng-if="!selectedList.labs.length && !selectedList.packages.length">Add all available Tests from selected prescription and proceed.</span></div><div class="modal-footer p-b-0 p-r-0"><button class="btn btn-primary btn-sm m-r-10" ng-click="refresh()"><span>Confirm</span></button><button class="btn btn-sm" ng-click="closeModal()"><span>Cancel</span></button></div></div>',scope:e,controller:["$scope","$uibModalInstance",function(e,a){e.closeModal=function(){a.dismiss("cancel"),s=null},h.sendEvents("Recent Prescription Book Lab Test Clicked"),e.refresh=function(){h.addItemsToCart(t.testsAvailable,"+",!1,!!M),e.closeModal()}}],size:n.isMobileView?"bottom":"border modal-sm",windowClass:n.isMobileView&&"bottom-sheet"})},e.cardPipeline.addItem=function(t,s,a,i){var n=T(a);if(t.source=n,h.sendEvents("Add To Cart Button Clicked",{CartSource:n},new Array(t)),i&&i.stopPropagation(),!s)return void(t.patientId=e.mergeList.defaultPatId);var o={};"hc-packages"==a&&(o.getAdditionalTests=!0,e.cardPipeline.overrideTests=!0),e.cardPipeline.showBenefPopup?I(new Array(t),"+",!1,!1,!0,o):h.addItemsToCart(new Array(t),"+",!1,!!M,o)},e.cardPipeline.removeItem=function(t,s,a,i){var n=T(a);h.sendEvents("Remove From Cart Button Clicked",{CartSource:n},new Array(t)),i&&i.stopPropagation(),s&&("hc-packages"==a&&(e.cardPipeline.overrideTests=!0),t.showCount>1?I(new Array(t),"-",!1,!1,!0):h.addItemsToCart(new Array(t),"-",!1,!!M))},e.searchPipeline.addToCart=function(){H=!0,h.sendEvents("Search Proceed Button Clicked",e.mergeList.searchCart),e.cardPipeline.showBenefPopup?I(e.mergeList.searchCart,"+",!0,!0,!0):h.addItemsToCart(e.mergeList.searchCart,"+",!0,!!M),e.dialog.searchPopover=!1},e.viewOrders=function(){h.sendEvents("Go To Active Bookings Buttons Clicked"),g.url("/patientlisting")},e.FetchFilteredPackages=function(e,t){"lifestyle"==t?h.sendEvents("Labs Lifestyle Service Icon Clicked",{serviceType:e.title}):"matrix"==t&&h.sendEvents("Labs Lifestyle Service Icon Clicked",{serviceType:e.label}),g.url("/consumerPackages?filter="+e.value)},e.goToTracking=function(e,t){g.url("/trackOrder?orderid="+e+"&patientId="+t)};var F={},V={},q={},R=null,$=["labSale-banners"];e.initializeGlider=function(t,s){q[t]=o(function(){F[t]=document.querySelector("#"+t),$.indexOf(t)>-1&&(R&&(f.cancel(R),R=null),F[t].addEventListener("glider-animated",function(e){R&&(f.cancel(R),R=null),R=f(D,5e3)})),F[t]&&(V[t]=new Glider(F[t],{slidesToShow:s&&2==s.length?e.isMobileView?s[1]:s[0]:e.isMobileView?1:2,slidesToScroll:s&&2==s.length?e.isMobileView?s[1]:s[0]:e.isMobileView?1:2,draggable:!1,skipTrack:!0,scrollLock:!0,arrows:["prev-booking"].includes(t)&&!e.isMobileView&&{prev:".prev-"+t,next:".next-"+t},dots:!(["prev-booking"].includes(t)&&!e.isMobileView)&&"#dots-"+t})),console.log(F,"carouselEl"),$.indexOf(t)>-1&&(V[t].setOption({duration:2}),R=f(D,3e3))},10)};var O=n.$on("userLogin",function(t,a){return M=s.isUserSignedin(),M&&M.userDetails&&!M.isMergeFlowEnabled?void(M.isRetailLabsFlowEnabled?c.go("app.labs"):g.url("/")):(S(),L(),h.removeCartLS(),void h.addItemsToCart(e.mergeList.selectedList[0],"+",!1,!0,{blockEvents:!0}))}),U=n.$on("userLogout",function(t,s){e.activeBookingList=[],e.prevBookings=[],e.rxData=[],e.showSponsBanner=!1,e.isMchiUser=!1,M=null,sessionStorage.removeItem("hideConsentForm"),e.benefArray=[],h.saveUniqCart()}),N=n.$on("userLocation",function(t,s){e.selectedCity=s.city,B=s.pincode,window._Site_Props.__setLocation(e.selectedCity,B),_.isEmpty(M)?h.getCartLS():h.getCartDetails()}),Y=e.$on("familyConfirmClicked",function(t,s,a){var i=[];if("+"==e.famPipeline.op?_.each(s,function(t){e.famPipeline.selectedItems.forEach(function(e){var s=JSON.parse(JSON.stringify(e));s.patientId=t.maid,s.relation=t.relationName,i.push(s)})}):_.each(e.famPipeline.selectedItems,function(t){_.each(e.mergeList.selectedList,function(e,a){const n=e.find(function(e){return e.packageId==t.packageId});if(n){const o=!s.find(function(e){return e.maid==a});o&&i.push(n)}})}),e.famPipeline.refreshCart){var n=s.map(function(e){return e.maid});_.each(_.union(e.mergeList.tests,e.mergeList.packages),function(e){n.includes(e.patientId)||i.push(e)})}h.addItemsToCart(i,e.famPipeline.op,e.famPipeline.refreshCart,!0,{getAdditionalTests:e.famPipeline.getAdditionalTests}),e.famPipeline={show:!1,selectedItems:[],op:"+",transit:!1,refreshCart:!1,getAdditionalTests:!1}}),G=e.$on("corporateBenefits",function(e,t){k()}),W=n.$on("cartItemsUpdated",function(t,s){e.mergeList=h.labsCart(),e.cartPipeline.testsCnt=e.mergeList.tests.length,e.cartPipeline.packagesCnt=e.mergeList.packages.length,e.cartPipeline.totalPrice=e.mergeList.totalPrice,e.cartPipeline.isLabVisit=e.mergeList.isLabVisit,e.cartPipeline.isLabVisit&&(e.cartPipeline.cvPackages=[],_.each(_.union(e.mergeList.tests,e.mergeList.packages),function(t){!t.isHomeSampleCollection&&e.cartPipeline.cvPackages.push(t.packageDisplayName)}),e.cartPipeline.cvPackages=_.uniq(e.cartPipeline.cvPackages)),e.cardPipeline.showBenefPopup=e.mergeList.patients.length>1,y(s.cartItems,s.op,s.refresh),!e.cardPipeline.showBenefPopup,H&&(H=!1,E())});e.$on("$destroy",function(e){O(),U(),x(),N(),Y(),W(),G(),_.each(q,function(e){o.cancel(e)}),h.searchPopover=!1,o.cancel(A),i.onclick=null,window.updateSrc=!1})}])})}();